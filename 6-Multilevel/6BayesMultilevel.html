<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>6: Bayesian and Multi-Level Models in Panel Contexts</title>
    <meta charset="utf-8" />
    <meta name="author" content="J. Seawright" />
    <meta name="date" content="2023-04-27" />
    <script src="6BayesMultilevel_files/header-attrs-2.21/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# 6: Bayesian and Multi-Level Models in Panel Contexts
]
.subtitle[
## Time Series and Panels
]
.author[
### <large>J. Seawright</large>
]
.institute[
### <small>Northwestern Political Science</small>
]
.date[
### April 27, 2023
]

---

class: center, middle




---
 

---
###Shared Intuition of Bayesian and Multilevel Models

* If each of our units has a time series model with its own parameters, that means there is a distribution of parameters across the units.

---

`$$y_{1,t} = \alpha_{1} + \beta_{1,0} (y_{1,t-1}) + \beta_{1,1} (x_{1,t}) + \cdots + \epsilon_{1,t}$$`

---
###Shared Intuition of Bayesian and Multilevel Models

The random-effects model that is widely used in panels assigns `\(\alpha_{i}\)` the normal distribution.

`$$y_{i,t} = \alpha_{i} + \gamma y_{i,t-1} + \mathbb{\beta} \mathbb{X}_{i} + \epsilon_{i,t}$$`
`$$\alpha \sim N(0,\sigma^2_{\mu})$$`

---

We can rewrite this as two stacked regression models:

`$$y_{i,t} = \alpha_{i} + \gamma y_{i,t-1} + \mathbb{\beta} \mathbb{X}_{i} + \epsilon_{i,t}$$`

`$$\alpha_{i} = \mu + \eta_{i}$$`

---

`$$y_{i,t} = \alpha_{i} + \gamma y_{i,t-1} + \mathbb{\beta} \mathbb{X}_{i} + \epsilon_{i,t}$$`

`$$\alpha_{i} = \mu + \mathbb{\delta}\mathbb{W_{i}} + \eta_{i}$$`

---

`$$y_{i,t} = \alpha_{i} + \gamma y_{i,t-1} + \mathbb{\beta_{i}} \mathbb{X}_{i} + \epsilon_{i,t}$$`

`$$\alpha_{i} = \mu + \mathbb{\delta}\mathbb{W_{i}} + \eta_{i}$$`
`$$\mathbb{\beta}_{i} = \upsilon + \mathbb{\lambda}\mathbb{V_{i}} + \tau_{i}$$`

---
### Bayesian Models

While multilevel models specify the distribution and try to estimate the rest from data, Bayesian models add a prior distribution that provides information about beliefs regarding the parameters of interest. This can be good --- or messy.


---

```r
library(lme4)
```

```
## Loading required package: Matrix
```

```
## 
## Attaching package: 'lme4'
```

```
## The following object is masked from 'package:nlme':
## 
##     lmList
```

```r
rightplotslme2 &lt;- lmer(rightwingplots ~ I(whitealone/totalpop) +
                            I((whitealone/totalpop)^2) +
                            unemployment24 + (1 + unemployment24 | state), 
                            data=usrightplotsexpanded, 
                            REML = FALSE)
```

```
## boundary (singular) fit: see help('isSingular')
```

---

```r
summary(rightplotslme2)
```

```
## Linear mixed model fit by maximum likelihood  ['lmerMod']
## Formula: 
## rightwingplots ~ I(whitealone/totalpop) + I((whitealone/totalpop)^2) +  
##     unemployment24 + (1 + unemployment24 | state)
##    Data: usrightplotsexpanded
## 
##      AIC      BIC   logLik deviance df.resid 
##   4099.7   4140.3  -2041.8   4083.7     1168 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.9841 -0.4374 -0.2212  0.1112  9.1458 
## 
## Random effects:
##  Groups   Name           Variance Std.Dev. Corr 
##  state    (Intercept)    0.929973 0.96435       
##           unemployment24 0.006637 0.08147  -1.00
##  Residual                1.775936 1.33264       
## Number of obs: 1176, groups:  state, 42
## 
## Fixed effects:
##                            Estimate Std. Error t value
## (Intercept)                -1.92577    1.06143  -1.814
## I(whitealone/totalpop)     11.60501    3.08090   3.767
## I((whitealone/totalpop)^2) -9.52573    2.22711  -4.277
## unemployment24             -0.08477    0.02789  -3.039
## 
## Correlation of Fixed Effects:
##             (Intr) I(wh/) I((/)^
## I(whtln/tt) -0.946              
## I((wht/)^2)  0.886 -0.984       
## unmplymnt24 -0.116 -0.103  0.127
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help('isSingular')
```

---

```r
summary(lm(unemployment24~state, data=usrightplotsexpanded))
```

```
## 
## Call:
## lm(formula = unemployment24 ~ state, data = usrightplotsexpanded)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.2370 -0.9885 -0.2518  0.7291  6.8200 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                5.96867    0.27272  21.886  &lt; 2e-16 ***
## stateAlaska                1.06000    0.38568   2.748 0.006078 ** 
## stateArizona               0.03567    0.38568   0.092 0.926335    
## stateArkansas             -0.44967    0.38568  -1.166 0.243884    
## stateDelaware             -0.95767    0.38568  -2.483 0.013160 *  
## stateDistrict of Columbia  1.57300    0.38568   4.078 4.83e-05 ***
## stateFlorida              -0.28133    0.38568  -0.729 0.465872    
## stateGeorgia              -0.12733    0.38568  -0.330 0.741343    
## stateHawaii               -1.35000    0.38568  -3.500 0.000482 ***
## stateIdaho                -0.74767    0.38568  -1.939 0.052787 .  
## stateIllinois              0.48067    0.38568   1.246 0.212903    
## stateIndiana              -0.64167    0.38568  -1.664 0.096427 .  
## stateIowa                 -1.95667    0.38568  -5.073 4.52e-07 ***
## stateKansas               -1.30033    0.38568  -3.372 0.000771 ***
## stateKentucky              0.11967    0.38568   0.310 0.756407    
## stateLouisiana             0.17667    0.38568   0.458 0.646990    
## stateMaine                -0.65367    0.38568  -1.695 0.090364 .  
## stateMaryland             -0.83400    0.38568  -2.162 0.030782 *  
## stateMassachusetts        -0.53367    0.38568  -1.384 0.166706    
## stateMichigan              0.82800    0.38568   2.147 0.032003 *  
## stateMinnesota            -1.52233    0.38568  -3.947 8.36e-05 ***
## stateMississippi           0.79233    0.38568   2.054 0.040153 *  
## stateMissouri             -0.51100    0.38568  -1.325 0.185445    
## stateMontana              -0.88633    0.38568  -2.298 0.021726 *  
## stateNebraska             -2.70633    0.38568  -7.017 3.75e-12 ***
## stateNevada                0.75133    0.38568   1.948 0.051637 .  
## stateNew Hampshire        -1.75133    0.38568  -4.541 6.16e-06 ***
## stateNew Jersey            0.17500    0.38568   0.454 0.650096    
## stateNew Mexico            0.19967    0.38568   0.518 0.604764    
## stateNew York              0.30833    0.38568   0.799 0.424187    
## stateNorth Carolina       -0.06567    0.38568  -0.170 0.864833    
## stateNorth Dakota         -2.68600    0.38568  -6.964 5.39e-12 ***
## stateOhio                  0.05533    0.38568   0.143 0.885944    
## stateOklahoma             -1.38000    0.38568  -3.578 0.000360 ***
## stateOregon                0.48467    0.38568   1.257 0.209123    
## statePennsylvania         -0.08267    0.38568  -0.214 0.830319    
## stateSouth Carolina        0.32833    0.38568   0.851 0.394768    
## stateTennessee            -0.22233    0.38568  -0.576 0.564406    
## stateTexas                -0.19167    0.38568  -0.497 0.619311    
## stateUtah                 -1.79600    0.38568  -4.657 3.57e-06 ***
## stateVermont              -1.81367    0.38568  -4.702 2.86e-06 ***
## stateVirginia             -1.52433    0.38568  -3.952 8.19e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.494 on 1218 degrees of freedom
##   (1778 observations deleted due to missingness)
## Multiple R-squared:  0.3056,	Adjusted R-squared:  0.2822 
## F-statistic: 13.07 on 41 and 1218 DF,  p-value: &lt; 2.2e-16
```

---

```r
rightplotslme3 &lt;- lmer(rightwingplots ~ I(whitealone/totalpop) +
                            I((whitealone/totalpop)^2) +
                            unemployment24 + demvoteshare +
                            (1 + demvoteshare | state), 
                            data=usrightplotsexpanded2, 
                            REML = FALSE)
```

---

```r
summary(rightplotslme3)
```

```
## Linear mixed model fit by maximum likelihood  ['lmerMod']
## Formula: 
## rightwingplots ~ I(whitealone/totalpop) + I((whitealone/totalpop)^2) +  
##     unemployment24 + demvoteshare + (1 + demvoteshare | state)
##    Data: usrightplotsexpanded2
## 
##      AIC      BIC   logLik deviance df.resid 
##   1019.5   1052.6   -500.7   1001.5      285 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -0.5831 -0.4102 -0.3371  0.2649  9.3319 
## 
## Random effects:
##  Groups   Name         Variance Std.Dev. Corr 
##  state    (Intercept)  0.10789  0.3285        
##           demvoteshare 0.09737  0.3120   -1.00
##  Residual              1.73300  1.3164        
## Number of obs: 294, groups:  state, 42
## 
## Fixed effects:
##                            Estimate Std. Error t value
## (Intercept)                -1.70037    1.38323  -1.229
## I(whitealone/totalpop)      5.37530    3.42350   1.570
## I((whitealone/totalpop)^2) -3.44484    2.45752  -1.402
## unemployment24             -0.01249    0.04961  -0.252
## demvoteshare                0.51967    0.86590   0.600
## 
## Correlation of Fixed Effects:
##             (Intr) I(wh/) I((/)^ unmp24
## I(whtln/tt) -0.878                     
## I((wht/)^2)  0.793 -0.982              
## unmplymnt24 -0.036 -0.208  0.241       
## demvoteshar -0.620  0.316 -0.237 -0.111
```

---

```r
democlme &lt;- lmer(p_polity2 ~ I(log(wdi_gdpcapcon2015)) +
                            wdi_oilrent+ (1 + I(log(wdi_gdpcapcon2015)) | cname), 
                            data=qog_std_ts_jan23, 
                            REML = FALSE)
```

---

```r
summary(democlme)
```

```
## Linear mixed model fit by maximum likelihood  ['lmerMod']
## Formula: 
## p_polity2 ~ I(log(wdi_gdpcapcon2015)) + wdi_oilrent + (1 + I(log(wdi_gdpcapcon2015)) |  
##     cname)
##    Data: qog_std_ts_jan23
## 
##      AIC      BIC   logLik deviance df.resid 
##  34331.1  34378.4 -17158.6  34317.1     6306 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.2340 -0.2374  0.0159  0.3879  3.7617 
## 
## Random effects:
##  Groups   Name                      Variance Std.Dev. Corr 
##  cname    (Intercept)               4713.65  68.656        
##           I(log(wdi_gdpcapcon2015))   87.95   9.378   -0.99
##  Residual                             10.64   3.261        
## Number of obs: 6313, groups:  cname, 164
## 
## Fixed effects:
##                            Estimate Std. Error t value
## (Intercept)               -26.31709    5.65829  -4.651
## I(log(wdi_gdpcapcon2015))   3.53626    0.76903   4.598
## wdi_oilrent                 0.01898    0.01081   1.756
## 
## Correlation of Fixed Effects:
##             (Intr) I((_20
## I(l(_2015)) -0.988       
## wdi_oilrent  0.024 -0.030
```

---

```r
democlme2 &lt;- lmer(p_polity2 ~ I(log(wdi_gdpcapcon2015)) +
                            wdi_oilrent+ (1 + wdi_oilrent | cname), 
                            data=qog_std_ts_jan23, 
                            REML = FALSE)
```

---

```r
summary(democlme2)
```

```
## Linear mixed model fit by maximum likelihood  ['lmerMod']
## Formula: 
## p_polity2 ~ I(log(wdi_gdpcapcon2015)) + wdi_oilrent + (1 + wdi_oilrent |  
##     cname)
##    Data: qog_std_ts_jan23
## 
##      AIC      BIC   logLik deviance df.resid 
##  35783.9  35831.2 -17885.0  35769.9     6306 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.2271 -0.2998  0.0583  0.4683  4.0152 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  cname    (Intercept) 26.573   5.155         
##           wdi_oilrent  1.601   1.266    -0.08
##  Residual             14.587   3.819         
## Number of obs: 6313, groups:  cname, 164
## 
## Fixed effects:
##                            Estimate Std. Error t value
## (Intercept)               -20.61677    1.16870 -17.641
## I(log(wdi_gdpcapcon2015))   2.79902    0.13465  20.787
## wdi_oilrent                 0.02384    0.16374   0.146
## 
## Correlation of Fixed Effects:
##             (Intr) I((_20
## I(l(_2015)) -0.936       
## wdi_oilrent -0.021 -0.008
```



---
### Tests for Cross-Sectional Correlation

Breusch and Pagan LM test
 
`$$LM = T \sum_{i=1}^{N-1} \sum_{j=i+1}^{N} \hat{\rho}^2_{i,j}$$`

This statistic asymptotically follows the `\(\chi^2\)` distribution when there is no cross-sectional correlation.


---

```r
library(plm)
```

```
## 
## Attaching package: 'plm'
```

```
## The following objects are masked from 'package:dplyr':
## 
##     between, lag, lead
```

```r
pcdtest(rightwingplots ~ I(whitealone/totalpop) +
                            I((whitealone/totalpop)^2) +
                            unemployment24,
                          effect = "individual",
                          model = "within",
                          data=usrightplotsexpanded,
                          index=c("state","year"),
        test="lm")
```

```
## 
## 	Breusch-Pagan LM test for cross-sectional dependence in panels
## 
## data:  rightwingplots ~ I(whitealone/totalpop) + I((whitealone/totalpop)^2) +     unemployment24
## chisq = 1662.9, df = 861, p-value &lt; 2.2e-16
## alternative hypothesis: cross-sectional dependence
```

---
### Tests for Cross-Sectional Correlation

* The Breusch-Pagan test can have poor properties when N is bigger than T.

* Pesaran has a more general alternative:
 
`$$CD = \sqrt{\frac{2T}{N(N-1)}} \left(\sum_{i=1}^{N-1}\sum_{j=i+1}^{N}\hat{\rho_{i,j}}\right)$$`

---

```r
pcdtest(rightwingplots ~ I(whitealone/totalpop) +
                            I((whitealone/totalpop)^2) +
                            unemployment24,
                          effect = "individual",
                          model = "within",
                          data=usrightplotsexpanded,
                          index=c("state","year"),
        test="cd")
```

```
## 
## 	Pesaran CD test for cross-sectional dependence in panels
## 
## data:  rightwingplots ~ I(whitealone/totalpop) + I((whitealone/totalpop)^2) +     unemployment24
## z = 8.2823, p-value &lt; 2.2e-16
## alternative hypothesis: cross-sectional dependence
```

---
### PCSEs

Suppose that we are concerned about:

* Contemporaneous cross-sectional correlations among units

* Heteroskedasticity at the unit variance level

---
### PCSEs

Then we can run an improved OLS panel regression model using the following to estimate standard errors:

`$$Cov(\hat{\beta})=((\mathbb{X}^{T}\mathbb{X})^{-1} (\mathbb{X}^{T}\mathbb{\Omega}\mathbb{X}) (\mathbb{X}^{T}\mathbb{X})^{-1})$$`

Here, `\(\mathbb{\Omega}\)` is  an NT x NT block diagonal matrix with an N x N matrix of contemporaneous covariances, `\(\mathbb{\Sigma}\)`, along the diagonal.

`$$\mathbb{\hat{\Sigma}}_{i,j}=\frac{\sum_{t=1}^{T} e_{i,t} e_{j,t}}{T}$$`
---

```r
rightplotsplm &lt;- plm(rightwingplots ~ I(whitealone/totalpop) +
                            I((whitealone/totalpop)^2) +
                            unemployment24,
                          effect = "individual",
                          model = "within",
                          data=usrightplotsexpanded,
                          index=c("state","year"))
```

---

```r
library(lmtest)
```

```
## Loading required package: zoo
```

```
## 
## Attaching package: 'zoo'
```

```
## The following objects are masked from 'package:base':
## 
##     as.Date, as.Date.numeric
```

```r
rightwingplots_pcse &lt;- coeftest(rightplotsplm, 
                                 vcov = vcovBK(rightplotsplm, 
                                               type="HC3", 
                                               cluster = "group"))
```

---

```r
rightwingplots_pcse 
```

```
## 
## t test of coefficients:
## 
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## I(whitealone/totalpop)      14.492719  12.431135  1.1658 0.243925    
## I((whitealone/totalpop)^2) -16.414895   8.136308 -2.0175 0.043881 *  
## unemployment24              -0.101930   0.028086 -3.6292 0.000297 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

```r
summary(rightplotsplm)
```

```
## Oneway (individual) effect Within Model
## 
## Call:
## plm(formula = rightwingplots ~ I(whitealone/totalpop) + I((whitealone/totalpop)^2) + 
##     unemployment24, data = usrightplotsexpanded, effect = "individual", 
##     model = "within", index = c("state", "year"))
## 
## Balanced Panel: n = 42, T = 28, N = 1176
## 
## Residuals:
##     Min.  1st Qu.   Median  3rd Qu.     Max. 
## -3.00375 -0.60489 -0.21886  0.26089 12.09403 
## 
## Coefficients:
##                              Estimate Std. Error t-value  Pr(&gt;|t|)    
## I(whitealone/totalpop)      14.492719   7.284949  1.9894 0.0468970 *  
## I((whitealone/totalpop)^2) -16.414895   4.753526 -3.4532 0.0005745 ***
## unemployment24              -0.101930   0.025997 -3.9208 9.356e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Total Sum of Squares:    2105.4
## Residual Sum of Squares: 1995.2
## R-Squared:      0.052315
## Adj. R-Squared: 0.015447
## F-statistic: 20.8117 on 3 and 1131 DF, p-value: 3.9669e-13
```

---
### PCSEs

* PCSEs want the time dimension to be substantially larger than the unit dimension. If the reverse is true, they are unreliable.

* They are also unreliable if there is autocorrelation in the errors.

---
### Serial and Cross-Sectional Correlation

* Driscoll and Kraay (1998) propose a GMM approach that addresses the same challenges as PCSEs but doesn't have those limitations.

---

```r
rightwingplots_scc &lt;- coeftest(rightplotsplm, 
                                 vcov = vcovSCC(rightplotsplm, 
                                               type="HC3", 
                                               cluster = "group"))
```

---

```r
rightwingplots_pcse 
```

```
## 
## t test of coefficients:
## 
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## I(whitealone/totalpop)      14.492719  12.431135  1.1658 0.243925    
## I((whitealone/totalpop)^2) -16.414895   8.136308 -2.0175 0.043881 *  
## unemployment24              -0.101930   0.028086 -3.6292 0.000297 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

```r
rightwingplots_scc
```

```
## 
## t test of coefficients:
## 
##                              Estimate Std. Error t value Pr(&gt;|t|)   
## I(whitealone/totalpop)      14.492719  15.536125  0.9328 0.351102   
## I((whitealone/totalpop)^2) -16.414895  10.093461 -1.6263 0.104167   
## unemployment24              -0.101930   0.031866 -3.1988 0.001419 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```


---
### PVCM

`$$Y_{i,t} = \alpha_{i} + \beta_{i} \mathbf{X}_{i,t} + \epsilon_{i,t}$$`
 

---
### PVCM+

`$$Y_{i,t} = \alpha_{i} + \beta_{i} \mathbf{X}_{i,t} + \epsilon_{i,t}$$`

`$$\alpha_{i} = a + \gamma \mathbf{W}_{i} + \delta_{i}$$`

`$$\beta_{i} = b + \pi \mathbf{V}_{i} + \nu_{i}$$`
 

 

 
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
